GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

You are using a CUDA device ('NVIDIA A30') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:613: UserWarning: Checkpoint directory ./pretrain_models exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]

  | Name  | Type           | Params
-----------------------------------------
0 | model | BIOTClassifier | 3.2 M
-----------------------------------------
3.2 M     Trainable params
22        Non-trainable params
3.2 M     Total params
12.755    Total estimated model params size (MB)
Sanity Checking DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s]{'accuracy': 0.24609375, 'cohen_kappa': 0.0, 'f1_weighted': 0.09720317398119123}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/functional.py:730: UserWarning: A window was not provided. A rectangular window will be applied,which is known to cause spectral leakage. Other windows such as torch.hann_window or torch.hamming_window are recommended to reduce spectral leakage.To suppress this warning and use a rectangular window, explicitly set `window=torch.ones(n_fft, device=<device>)`. (Triggered internally at /pytorch/aten/src/ATen/native/SpectralOps.cpp:836.)
  return _VF.stft(  # type: ignore[attr-defined]
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:06<00:00,  2.02it/s, loss=2.8, v_num=-100]{'accuracy': 0.2646239554317549, 'cohen_kappa': 0.018587360594795488, 'f1_weighted': 0.17160906825178926}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py:1609: PossibleUserWarning: The number of training batches (10) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.36it/s, loss=2.22, v_num=-100]{'accuracy': 0.2618384401114206, 'cohen_kappa': 0.01827544218108279, 'f1_weighted': 0.143559354924783}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.37it/s, loss=1.56, v_num=-100]{'accuracy': 0.27019498607242337, 'cohen_kappa': 0.02850709578797328, 'f1_weighted': 0.20508729712061646}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.30it/s, loss=1.46, v_num=-100]{'accuracy': 0.2562674094707521, 'cohen_kappa': 0.007455499984467706, 'f1_weighted': 0.12562065959390384}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.29it/s, loss=1.43, v_num=-100]{'accuracy': 0.27298050139275765, 'cohen_kappa': 0.029739776951672847, 'f1_weighted': 0.21165844130965325}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.32it/s, loss=1.43, v_num=-100]{'accuracy': 0.28133704735376047, 'cohen_kappa': 0.04171581103730837, 'f1_weighted': 0.20846592045663273}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 6: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.31it/s, loss=1.43, v_num=-100]{'accuracy': 0.2646239554317549, 'cohen_kappa': 0.01987631595276007, 'f1_weighted': 0.21887903795252808}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 7: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.28it/s, loss=1.42, v_num=-100]{'accuracy': 0.27019498607242337, 'cohen_kappa': 0.02631469979296064, 'f1_weighted': 0.22501836373898798}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 8: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.31it/s, loss=1.42, v_num=-100]{'accuracy': 0.27298050139275765, 'cohen_kappa': 0.030000931705953526, 'f1_weighted': 0.21437550413985582}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 9: 100%|███████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.37it/s, loss=1.42, v_num=-100]{'accuracy': 0.27019498607242337, 'cohen_kappa': 0.026173565527094933, 'f1_weighted': 0.197866099404697}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:03<00:00,  3.30it/s, loss=1.38, v_num=-100]{'accuracy': 0.2785515320334262, 'cohen_kappa': 0.037204630645929604, 'f1_weighted': 0.22997881713406057}
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:04<00:00,  3.22it/s, loss=1.38, v_num=-100]
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  6.10it/s]
You are using a CUDA device ('NVIDIA A30') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Restoring states from the checkpoint path at ./pretrain_models/best-epoch=05-val_cohen=0.0417.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
Loaded model weights from checkpoint at ./pretrain_models/best-epoch=05-val_cohen=0.0417.ckpt
/mnt/disk1/aiotlab/envs/hieupcvp/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m [0m[1m  Runningstage.testing   [0m[1m [0m┃[1m                           [0m┃
┃[1m [0m[1m         metric          [0m[1m [0m┃[1m [0m[1m      DataLoader 0       [0m[1m [0m┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│[36m [0m[36m        test_acc         [0m[36m [0m│[35m [0m[35m   0.2329317331314087    [0m[35m [0m│
│[36m [0m[36m       test_cohen        [0m[36m [0m│[35m [0m[35m  -0.02079845406115055   [0m[35m [0m│
│[36m [0m[36m         test_f1         [0m[36m [0m│[35m [0m[35m   0.1679994761943817    [0m[35m [0m│
└───────────────────────────┴───────────────────────────┘
{'test_acc': 0.2329317331314087, 'test_cohen': -0.02079845406115055, 'test_f1': 0.1679994761943817}
